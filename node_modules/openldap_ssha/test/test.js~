var should = require('should')
var ssha = require('../lib/ssha')

describe('Array', function(){
  describe('#indexOf()', function(){
    it('should return -1 when the value is not present', function(){
      assert.equal(-1, [1,2,3].indexOf(5));
      assert.equal(-1, [1,2,3].indexOf(0));
    })
  })
})


var passwd = 'secret'
describe('ssha_pass',function(){
    describe('known password',function(){
        it('should equal the value from Perl code',function(){
            ssha.ssha_pass(passwd, 'salt' , function(err,hash){
                should.not.exist(err);
                should.exist(hash);
                hash.should.equal('{SSHA}gVK8WC9YyFT1gMsQHTGCgT3sSv5zYWx0');
            })

    checkssha(passwd,hash,function(err,result){
        if(err) return console.log('checkssha error '+err)
        if(hash ==
            console.log('got what was expected')
            console.log('checkssha result = '+result)
        }
        return null;
    })
})

ssha_pass(passwd , function(err,hash){
    checkssha(passwd,hash,function(err,result){
        if(err) return console.log('checkssha error '+err)
        console.log('checkssha result = '+result)
        return null;
    })
})
